import os

import readJason
from readJason import ReadJason
from readJason import ParseSinglePatientConfig
from readJason import MergeFilesFromTwoFolder
  
  
  
  
  ###  this used to ininit only single specified patient with condition patient_case_name, 
    ###  which got from Json config, as "patient_case_1"
def init_paras(json_config_dir,jason_config_name,patient_case_name):
    global patient_path_CS, exe_path_CS, exe_path_Upsala, machine_path_CS, ED_path_CS, output_path
    data = ReadJason(json_config_dir,jason_config_name)
    if not data.patient_cases_dict.has_key(patient_case_name):
        print 'key with patient_case_name: ' + patient_case_name + ' not exits in jason file.'
    patients_lst_item  = [patient_case_name,data.patient_cases_dict.get(patient_case_name)] 
    patient_initi_cong = ParseSinglePatientConfig(patients_lst_item)   
    ### merge patient data and ED data
    patient_path_CS = MergeFilesFromTwoFolder(os.path.join(data._patient_temp_dir, patient_initi_cong.patient_tempfile_name),
                                         os.path.join(data._ED_temp_dir, patient_initi_cong._ED_file_name),
                                         os.path.join(data._output_path,patient_case_name))
    patient_path_CS = patient_path_CS.OutPut_dir +'\\'
    exe_path_CS = os.path.join(os.path.join(data._CS_exe_root, patient_initi_cong._CS_exe_name),"ProtonScanning.exe")                                        
    machine_path_CS = os.path.join(data._Machine_temp_dir, patient_initi_cong._Machine_file_name) + '\\'   
    ED_path_CS = os.path.join(data._ED_temp_dir, patient_initi_cong._ED_file_name)
    #### TODO: prepare Upsala patient data: interfaces 
    patient_path_Upsala = "D:/TestData/test_98_Upsala/"    
    exe_path_Upsala = "D:/code/Jedi_Proton_CarbonScanning/x64/Release/ProtonScanning.exe" ##TODO: change to upsala exe     
    output_path = data._output_path